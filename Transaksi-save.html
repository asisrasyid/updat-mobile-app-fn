<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Managament Finance</title>
		<!-- <link rel="manifest" href="/updat-mobile-app-fn/manifest.json" /> -->
  		<meta name="theme-color" content="#4CAF50"/>
  		<link rel="icon" href="https://cdn-icons-png.flaticon.com/512/906/906334.png" />

		<!-- all css -->
		<link rel="stylesheet" href="assets/css/bootstrap.min.css" />
		<link rel="stylesheet" href="assets/css/jquery-ui.css" />
		<link rel="stylesheet" href="assets/css/slick.css" />
		<link rel="stylesheet" href="assets/css/line-awesome.css" />
		<link rel="stylesheet" href="assets/css/nice-select.css" />
		<link rel="stylesheet" href="assets/css/style.css" />
		<link rel="stylesheet" href="assets/css/responsive.css" />
		<link rel="stylesheet" href="assets/sweetalert2/sweetalert2.css">
	</head>

	<body>
		<div id="loadingOverlay" style="display:none;">
            <div class="spinner"></div>
          </div>
		<!-- Preloader -->
		<!-- <div class="preloader">
			<img src="assets/images/preloader.gif" alt="preloader" />
		</div> -->

		<!-- Settings -->
		<div class="theme_settings">
			<button type="button" id="settings_toggler">
				<i class="las la-cog"></i>
			</button>
			<h3>Settings</h3>

			<h5>Primary Colors</h5>
			<div class="setting_colors">
				<button data-color="#FD3D57" class="prime_1 change_prime_color">
					<i class="icon las la-check"></i>
				</button>
				<button data-color="#3498db" class="prime_2 change_prime_color">
					<i class="icon las la-check"></i>
				</button>
				<button data-color="#1abc9c" class="prime_3 change_prime_color">
					<i class="icon las la-check"></i>
				</button>
				<button data-color="#F79F1F" class="prime_4 change_prime_color">
					<i class="icon las la-check"></i>
				</button>
			</div>

			<h5>Secondary Colors</h5>
			<div class="setting_colors">
				<button data-color="#18181b" class="second_1 change_sec_color">
					<i class="icon las la-check"></i>
				</button>
				<button data-color="#1e293b" class="second_2 change_sec_color">
					<i class="icon las la-check"></i>
				</button>
				<button data-color="#374151" class="second_3 change_sec_color">
					<i class="icon las la-check"></i>
				</button>
				<button data-color="#44403c" class="second_4 change_sec_color">
					<i class="icon las la-check"></i>
				</button>
			</div>
            <h5>System shortcut</h5>
			<div class="mt-2">                 
				<button type="button" id="pembahruandata" class="btn btn-outline-primary">
					 Reload
				</button>
			</div>
		</div>
		<!-- top header -->
		<header class="home-3">
			<div class="container">
				<div class="d-flex align-items-center justify-content-sm-between">
					<div class="logo">
					</div>
					<div class="search_wrap d-none d-lg-block">
					</div>
					<div class="header_icon d-flex align-items-center ms-auto ms-sm-0">
						<div class="shopcart">
						</div>
						<div class="position-relative myacwrap home-1">
							<a href="javascript:void(0)" class="icon_wrp text-center myacc">
								<span class="icon">
									<i class="las la-user-circle" style="font-size: 30px;"></i>
								</span>
								<span class="icon_text">Account</span>
							</a>
							<div class="myacc_cont">
								<div class="ac_links">
									<a href="account.html" class="myac">
										<i class="lar la-id-card"></i>
										My Account
									</a>
									<a href="settup-fn.html">
										<i class="las la-robot"></i>
										Setting
									</a>
									<a href="javascript:void(0)" id="LogOutSistem">
										<i class="las la-power-off"></i>
										Log out
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</header>

		<!-- navbar -->
		<nav class="d-none d-lg-block home-3">
			<div class="container">
				<div class="d-flex">
					<ul class="nav_bar flex-grow-1">
						<li class="withsubs">
							<a href="index-1.html"
								>Home <span><i class="las la-angle-down"></i></span
							></a>
							<ul class="subnav">
								<li><a href="index-1.html">Home page 1 </a></li>
								<li><a href="index-2.html">Home page 2</a></li>
								<li><a href="index-3.html">Home page 3</a></li>
							</ul>
						</li>
						<li class="withsubs">
							<a href="shop-list.html"
								>Shop <span><i class="las la-angle-down"></i></span
							></a>
							<ul class="subnav">
								<li><a href="shop-list.html">List view </a></li>
								<li><a href="shop-grid.html">Grid view</a></li>
								<li><a href="shop-grid-2.html">Grid view 2</a></li>

								<li><a href="shopping-cart.html">Shopping cart</a></li>
								<li><a href="product-view.html">Product view</a></li>
							</ul>
						</li>
						<li class="withsubs">
							<a href="shop-list.html"
								>Pages <span><i class="las la-angle-down"></i></span
							></a>
							<div class="subnav py-3 px-2 d-flex gx-4">
								<div class="single_subnav">
									<h5 class="text_lg ps-3 mb-2">Others pages</h5>
									<ul>
										<li><a href="about-us.html">About us</a></li>
										<li><a href="contact-us.html">Contact us</a></li>

										<li><a href="track-order.html">Track order</a></li>
										<li><a href="faq.html">FAQ</a></li>
										<li><a href="404.html">404</a></li>
									</ul>
								</div>
								<div class="single_subnav">
									<h5 class="text_lg ps-3 mb-2">Account pages</h5>
									<ul>
										<li><a href="account.html">My Account</a></li>
										<li><a href="login.html">Login</a></li>
										<li><a href="register.html">Register</a></li>
										<li><a href="shop-grid.html">Forgot password</a></li>
									</ul>
								</div>
								<div class="single_subnav">
									<h5 class="text_lg ps-3 mb-2">Checkout page</h5>
									<ul>
										<li><a href="shop-list.html">Checkout</a></li>
										<li><a href="shop-list.html">Payment</a></li>
										<li><a href="shop-list.html">Payment success</a></li>
									</ul>
								</div>
							</div>
						</li>
						<li><a href="contact-us.html">contact</a></li>
						
					</ul>
				</div>
			</div>
		</nav>

		<!-- mobile bottom bar -->
		<div class="mobile_bottombar d-block d-lg-none">
			<div class="header_icon">
				<a href="index.html" class="icon_wrp text-center">
					<span class="icon">
						<i class="las la-chart-bar"></i>
					</span>
					<span class="icon_text">Dashboard</span>
				</a>
				<a href="javascript:void(0)" class="icon_wrp text-center open_menu">
					<span class="icon">
						<i class="las la-bars"></i>
					</span>
					<span class="icon_text">Menu</span>
				</a>
				<a href="Transaksi-save.html" class="icon_wrp text-center">
					<span class="icon">
						<i class="las la-edit"></i>
					</span>
					<span class="icon_text">Simpan Transaksi</span>
				</a>
			</div>
		</div>

		<!-- mobile menu -->
		<div class="mobile_menwrap d-lg-none" id="mobile_menwrap">
			<div class="mobile_menu_2">
				<h5 class="mobile_title">
					Menu
					<span class="sidebarclose" id="menuclose">
						<i class="las la-times"></i>
					</span>
				</h5>
				<ul>
					<li class="">
						<a href="index.html">Dashboard</a>
					</li>

					<li class="">
						<a href="plan-saveing.html">Saveing-Plan</a>
					</li>
					<li class=""> 
						<a href="budgeting-view.html">Budgeting</a>
					</li>
					<li class="">
						<a href="riwayat-transaksi.html">Riyawat Transaksi</a>
					</li>
				</ul>
			</div>
		</div>

		<!--  mobile cart -->
		<div class="mobile_menwrap d-lg-none" id="mobileCart">
			<div class="mobile_cart_wrap d-flex flex-column">
				<h5 class="mobile_title">
					Cart
					<span class="sidebarclose" id="mobileCartClose">
						<i class="las la-times"></i>
					</span>
				</h5>
				<div class="px-3 py-3 flex-grow-1 d-flex flex-column">
					<div class="cart_droptitle">
						<h4 class="text_lg">Total 2 Items</h4>
					</div>
					<div class="cartsdrop_wrap">
						<a href="product-view.html" class="single_cartdrop mb-3">
							<span class="remove_cart"><i class="las la-times"></i></span>
							<div class="cartdrop_img">
								<img loading="lazy" src="assets/images/shoes-5.png" alt="product" />
							</div>
							<div class="cartdrop_cont">
								<h5 class="text_lg mb-0 default_link">Men casual shoes</h5>
								<p class="mb-0 text_xs text_p">x1 <span class="ms-2">$450</span></p>
							</div>
						</a>
						<a href="product-view.html" class="single_cartdrop">
							<span class="remove_cart"><i class="las la-times"></i></span>
							<div class="cartdrop_img">
								<img loading="lazy" src="assets/images/headphone-2.png" alt="product" />
							</div>
							<div class="cartdrop_cont">
								<h5 class="text_lg mb-0 default_link">Men casual shoes</h5>
								<p class="mb-0 text_xs text_p">x1 <span class="ms-2">$450</span></p>
							</div>
						</a>
					</div>
					<div class="mt-auto">
						<div class="total_cartdrop">
							<h4 class="text_lg text-uppercase mb-0">Sub Total:</h4>
							<h4 class="text_lg mb-0 ms-2">$980.00</h4>
						</div>
						<div class="cartdrop_footer mt-3 d-flex">
							<a href="shopping-cart.html" class="default_btn w-50 text_xs px-1">View Cart</a>
							<a href="checkout.html" class="default_btn second ms-3 w-50 text_xs px-1">Checkout</a>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="container-lg home_2_hero_wrp home-3">
			<div class="row">
				<div class="col-xl-12">
					<div class="home_2_hero">
						<div class="container">
							<div class="my_account_wrap section_padding_b">
								<div class="container">
									<div class="row">
										<div class="col-xl-12 col-lg-12 col-sm-12">
											<div class="col-lg-12" style="margin-top: 10px ;">
												<div class="account_sidebar">
													<div class="account_profile position-relative shadow_sm">
														<div class="acprof_img">
															<a href="account.html">
																<img loading="lazy" src="assets/images/avatar-2.png" alt="user" />
															</a>
														</div>
														<div class="acprof_cont">
															<p>Hello,</p>
															<h4 class="output"></h4>
														</div>
													</div>
												</div>
											</div>
											<div class="acprof_info_wrap shadow_sm">
												<h4 class="text_xl mb-3">Catat Transaksi</h4>
												<form id="dataForm">
													<div class="row">
														<div class="col-md-6">
															<div class="single_billing_inp select-wrapper">
																<select class="" id="JenisTransaksi">
																	<option>Pilih Jenis</option>
																</select>
															</div>
														</div>
														<div class="col-md-6">
															<div class="single_billing_inp select-wrapper">
																<select class="" id="keteranganDropdown">
																	<option>Pilih Kategori</option>
																</select>
															</div>
														</div>
														<div class="col-md-6">
															<div class="single_billing_inp select-wrapper">
																<select class="" id="enumDropdown">
																	<option>Pilih Subkategori</option>
																</select>
															</div>
														</div>
														<div class="col-md-6" id="loanShow" style="display: none;">
															<div class="single_billing_inp select-wrapper">
																<select class="" id="loanDropdown">
																	<option>Pilih Hutang</option>
																</select>
															</div>
														</div>
														<input type="text" name="Jenis" id="inputJenis" hidden>
														<input type="text" name="Kategori" id="inputKategori" hidden>
														<input type="text" name="Subkategori" id="inputSubkategori" hidden>
														<div class="col-md-6">
															<div class="single_billing_inp">
																<input type="text" class="input-styled" name="Keterangan" placeholder="Keterangan" required />
															</div>
														</div>
														<div class="col-md-6">
															<div class="single_billing_inp">
															  <input type="number" class="input-styled" name="Jumlah" placeholder="Jumlah (Rp)" required />
															</div>
														  </div>
														  
														  <!-- Dropdown untuk sumber (jika jenis = pengeluaran) -->
														  <div class="col-md-6" id="dropdownSumberContainer">
															<div class="single_billing_inp select-wrapper">
															  <select class="" id="bySumber">
																<option value="">Pilih Sumber</option>
															  </select>
															</div>
														  </div>
														  
														  <!-- Input manual sumber (jika jenis ≠ pengeluaran) -->
														  <div class="col-md-6" id="inputSumberContainer" style="display: none;">
															<div class="single_billing_inp">
															  <input type="text"  class="input-styled" id="manualSumberInput" value="-" placeholder="Masukkan Sumber" />
															</div>
														  </div>

														  <div class="col-md-6" id="DataLain" style="display: none;">
															<div class="single_billing_inp">
															  <h5 class="text-black">Tanggal Jatuh Tempo</h5>
																<input type="date" class="input-styled" id="DataLainInput" placeholder="Masukkan Tanggal Pembayaran" />
															</div>
														  </div>

														  <div class="col-md-6" id="DataLainInput" style="display: none;">
															<div class="single_billing_inp">
															  <input type="text"  class="input-styled" id="manualDataLain" placeholder="Maasukan Data" />
															</div>
														  </div>
														  
														  <!-- Hidden input yang akan disubmit ke server -->
														  <input type="text" name="Sumber" id="inputSumber" hidden /> 
														  <input type="text" name="DataLain" id="inputDataaLain" hidden />
														  
														<div class="col-12 acprof_subbtn">
															<button type="submit" class="default_btn rounded small" id="submitButton">Simpan Data</button>
														</div>
													</div>
												</form>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- copyright -->
		<div class="copyright_wrap">
			<div class="container">
				<div class="row align-items-center">
					<div class="col-md-6">
						<p class="copyright_text">2025 | Finance Management</p>
					</div>
				</div>
			</div>
		</div>
	
	
		<script>
			if ('serviceWorker' in navigator) {
				navigator.serviceWorker.register('service-worker.js')
					.then(() => console.log("✅ Service Worker registered"))
					.catch(err => console.log("❌ SW error", err));
			}
		</script> 
		<!-- all js -->
		<script src="assets/js/bootstrap.bundle.min.js"></script>
		<script src="assets/js/jquery-3.5.1.min.js"></script>
		<script src="assets/js/jquery-ui.min.js"></script>
		<script src="assets/js/slick.min.js"></script>
		<script src="assets/js/jquery.nice-select.min.js"></script>
		<script src="assets/sweetalert2/sweetalert2.js"></script>
		<script src="assets/js/app.js"></script>
		<script src="app-transaksi-page.js"></script>
		<!-- <script>
		//	https://script.google.com/macros/s/AKfycbyBfKNeW5yhAyL8BdaJo6AhkbVfEPeorcqOMjPElrCCZJU9sQpCKpWwGAAqSYqKSqFw2g/exec
			const spreadsheetUrl = "https://script.google.com/macros/s/AKfycbyBfKNeW5yhAyL8BdaJo6AhkbVfEPeorcqOMjPElrCCZJU9sQpCKpWwGAAqSYqKSqFw2g/exec?dataset=accdta"; 
			const savedUser = localStorage.getItem('user');
			const outputElements = document.querySelectorAll('.output');
			if (savedUser) {
				outputElements.forEach(el => el.textContent = savedUser);
			 }
			 else {
				window.location.href = "login.html"; 	
			 }
			
			</script>
		<script> 
			const spreadsheetUrl2 = "https://script.google.com/macros/s/AKfycbyBfKNeW5yhAyL8BdaJo6AhkbVfEPeorcqOMjPElrCCZJU9sQpCKpWwGAAqSYqKSqFw2g/exec"; 
			const submitButton = document.getElementById("submitButton");   
			document.getElementById("dataForm").addEventListener("submit", function(e){
				e.preventDefault();
				submitButton.disabled = true;
  				submitButton.textContent = "Menyimpan Data.";
				const form = e.target;
				const formData = new FormData(form);
				fetch(spreadsheetUrl2, {
				  method: "POST",
				  body: formData,
				  redirect: 'follow'
				})
				.then(res => res.json())
				.then(text => {
				if(!text.success) {
					Swal.fire({
					title: 'Ups!',
					text: text.message,
					icon: 'warning',
					confirmButtonText: 'Sorry!'
				  });
				} else {
					Swal.fire({
					title: 'Berhasil Simpan!',
					text: text.message,
					icon: 'success',
					confirmButtonText: 'Sip!'
				  });
				  form.reset();
				  resetDivDisplay();
				}  
				submitButton.disabled = false;
      			submitButton.textContent = "Simpan Data"
				})
				.catch(err => {
				  Swal.fire({
					title: 'Ups!',
					text: err,
					icon: 'warning',
					confirmButtonText: 'Sorry!'
				  });
		  			submitButton.disabled = false;
      				submitButton.textContent = "Simpan Data"
				  console.log(err);
				  document.getElementById("result").innerText = "❌ Terjadi kesalahan.";
				});
			  });
			</script>
			<script>
			function PenampilDropDown(data) {
					const jenisDropdown = document.getElementById("JenisTransaksi");
				  	const kelompokDropdown = document.getElementById("keteranganDropdown");
				  	const enumDropdown = document.getElementById("enumDropdown");
				  	const sumberDropdown = document.getElementById("bySumber");
				  	const manualSumberInput = document.getElementById("manualSumberInput");
				  	const inputSumber = document.getElementById("inputSumber");
				
				  	const inputLoanData = document.getElementById("loanDropdown");
				  	const showLoan = document.getElementById("loanShow");
				  	const inputJenis = document.getElementById("inputJenis");
				  	const inputKategori = document.getElementById("inputKategori");
				  	const inputSubkategori = document.getElementById("inputSubkategori");

				  	const dropdownSumberContainer = document.getElementById("dropdownSumberContainer");
				  	const inputSumberContainer = document.getElementById("inputSumberContainer");
					  
				  	const DataLain = document.getElementById("DataLain");
					const inputDataaLain = document.getElementById("inputDataaLain");

				  	data.bySumber.forEach(sumber => {
				  		const opt = document.createElement("option");
				  		opt.value = sumber;
				  		opt.textContent = sumber;
				  		sumberDropdown.appendChild(opt);
					});

					sumberDropdown.addEventListener("change", function () {
						inputSumber.value = this.value;
					});
					
					manualSumberInput.addEventListener("input", function () {
						inputSumber.value = this.value;
					});
				  
				  	Object.keys(data.byJenis).forEach(jenis => {
						const opt = document.createElement("option");
						opt.value = jenis;
						opt.textContent = jenis;
						jenisDropdown.appendChild(opt);
						$('.preloader').fadeOut(500, function(){ $('.preloader').remove(); } );
				  	});
				  
					jenisDropdown.addEventListener("change", function () {
					  const selectedJenis = this.value;
					  inputJenis.value = selectedJenis; 
					  
					  if (selectedJenis.toLowerCase() === "perpindahan") {
 						   kelompokDropdown.innerHTML = '<option>Pilih Asal</option>';
 						   enumDropdown.innerHTML = '<option>Pilih Tujuan</option>';
 						 } 
						 else {
 						   kelompokDropdown.innerHTML = '<option>Pilih Kelompok</option>';
 						   enumDropdown.innerHTML = '<option>Pilih Keterangan</option>';
 						 }

					  inputKategori.value = '';
					  inputSubkategori.value = '';
					  inputSumber.value = '';
					  if (selectedJenis.toLowerCase() === "pengeluaran") {
  						  sumberDropdown.style.display = "block";
  						  dropdownSumberContainer.style.display = "block";
  						  inputSumberContainer.style.display = "none";
  						  manualSumberInput.required = false;
  						  inputSumber.value = sumberDropdown.value || "";
  						} else if (selectedJenis.toLowerCase() === "pemasukan")
						{
						  sumberDropdown.style.display = "block";
  						  dropdownSumberContainer.style.display = "block";
  						  inputSumberContainer.style.display = "none";
  						  manualSumberInput.required = false;
  						  inputSumber.value = sumberDropdown.value || "";
						} else{
  						  sumberDropdown.style.display = "none";
  						  dropdownSumberContainer.style.display = "none";
  						  inputSumberContainer.style.display = "block";
  						  manualSumberInput.required = true;
  						  inputSumber.value = manualSumberInput.value;
  						}
					  
						if (data.byJenis[selectedJenis] && selectedJenis.toLowerCase() ==="perpindahan") {
							data.bySumber.forEach(kelompok => {
								const opt = document.createElement("option");
								opt.value = kelompok;
								opt.textContent = kelompok;
								kelompokDropdown.appendChild(opt);
							});
						} else if (data.byJenis[selectedJenis]){
							data.byJenis[selectedJenis].forEach(kelompok => {
								const opt = document.createElement("option");
								opt.value = kelompok;
								opt.textContent = kelompok;
								kelompokDropdown.appendChild(opt);
							});
						}
					});
					
					kelompokDropdown.addEventListener("change", function () {
						const selectedKelompok = this.value;
						inputKategori.value = selectedKelompok; 
						
						const jeniscek = jenisDropdown.value;
						console.log(jeniscek); 
						
						inputSubkategori.value = '';
						if (jeniscek.toLowerCase() ==="perpindahan") {
							data.bySumber.forEach(keterangan => {
								if(keterangan != selectedKelompok) {
									const opt = document.createElement("option");
									opt.value = keterangan;
									opt.textContent = keterangan;
									enumDropdown.appendChild(opt);
								}
							});
						} else if (selectedKelompok.toLowerCase() === "tabungan") {
							data.bySave.forEach(keterangan => {
								const opt = document.createElement("option");
									opt.value = keterangan;
									opt.textContent = keterangan;
									enumDropdown.appendChild(opt);
							});
						} 
						else if (data.byKelompok[selectedKelompok]) {
							data.byKelompok[selectedKelompok].forEach(keterangan => {
								const opt = document.createElement("option");
								opt.value = keterangan;
								opt.textContent = keterangan;
								enumDropdown.appendChild(opt);
							});
						} 
						const DataLoanJsn = data.byLoan.map(item => item.KeteranganLoan);
						DataLoanJsn.forEach(KeteranganLoan =>{
							const opt = document.createElement("option");
								opt.value = KeteranganLoan;
								opt.textContent = KeteranganLoan;
								inputLoanData.appendChild(opt);
						})
					});
					
					enumDropdown.addEventListener("change", function () {
						const selectedSubkategori = this.value;
						console.log(selectedSubkategori)
						inputSubkategori.value = selectedSubkategori;
						manualSumberInput.value = inputKategori.value;

						if (selectedSubkategori.toLowerCase() === "pinjaman pribadi") {
							DataLain.style.display = "block"
						} else if (inputJenis.value.toLowerCase() === "pengeluaran" && selectedSubkategori.toLowerCase() === "pribadi"){
							showLoan.style.display="block"
						}
					});

					inputLoanData.addEventListener("change", function(){
						const inputloadval = this.value;
						inputSubkategori.value = inputloadval;

					})
					document.getElementById("DataLainInput").addEventListener("change", function () {
						const selectedDate = this.value; 
						document.getElementById("inputDataaLain").value = selectedDate;
					});

					sumberDropdown.addEventListener("change", function () {
						inputSumber.value = this.value;
						console.log(inputSumber.value)
					});

					manualSumberInput.addEventListener("input", function () {
						inputSumber.value = this.value;
					});
			}	
			
			function ambildaatadrop(){
			const spreadsheetUrl = "https://script.google.com/macros/s/AKfycbyBfKNeW5yhAyL8BdaJo6AhkbVfEPeorcqOMjPElrCCZJU9sQpCKpWwGAAqSYqKSqFw2g/exec?dataset=bckdata";		
			const datalocaldrop = localStorage.getItem('data-drop');
			if(datalocaldrop) {
				const prosesdata = JSON.parse(datalocaldrop);
				PenampilDropDown(prosesdata);
			} else {
				fetch(spreadsheetUrl)
			  		.then(res => res.json())
			  		.then(data => {
						localStorage.setItem('data-drop', JSON.stringify(data));
						PenampilDropDown(data)
						$('.preloader').fadeOut(500, function(){ $('.preloader').remove(); } );
				})
				.catch(err => console.error('Gagal ambil data:', err));
			}
			}
			document.addEventListener('DOMContentLoaded', ambildaatadrop);
			document.getElementById("pembahruandata").addEventListener("click", function(event) {
            event.preventDefault();
            document.getElementById("loadingOverlay").style.display = "flex";
			const spreadsheetUrlSvdt = "https://script.google.com/macros/s/AKfycbyBfKNeW5yhAyL8BdaJo6AhkbVfEPeorcqOMjPElrCCZJU9sQpCKpWwGAAqSYqKSqFw2g/exec?dataset=bckdata";		
			fetch(spreadsheetUrlSvdt) 
                .then(res => res.json())
                .then(res => {
                  localStorage.setItem('data-drop', JSON.stringify(res));
                  window.location.reload();
                  //tampilkanDataKeUI(res.value);
                })
                .catch(err => {console.error('Gagal ambil data:', err); document.getElementById("loadingOverlay").style.display = "none";});
        });
		function resetDivDisplay() {
    		const divsToHide = [
        "DataLainInput",
        "DataLain",
        "inputSumberContainer",
		"loanShow"
    		];

    		divsToHide.forEach(id => {
        		const el = document.getElementById(id);
        		if (el) el.style.display = "none";
    		});
		}
			</script>
				<script>
					document.getElementById("LogOutSistem").addEventListener("click", function (e) {
					  e.preventDefault(); 
					  localStorage.clear(); 
					  window.location.href = "index.html"; 
					});
				  </script>	 -->
	</body>
</html>
